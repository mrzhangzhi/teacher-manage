<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zt.manage.mapper.UserMapper">

    <select id="selectByPhoneNoAndPassword" resultType="user">
        select * from sys_user where phone_no=#{phoneNo} and password=#{password}
    </select>

    <select id="selectByUserId" resultType="com.zt.manage.domain.pojo.user.User">
        select * from sys_user where user_id=#{userId}
    </select>

    <select id="selectRoleByUserId" resultType="java.lang.Integer">
        select role_id from sys_user_role_mapper_list where user_id=#{userId}
    </select>

    <sql id="ListQuerySql">
        from sys_user
        <where>
            <if test="query != null and query != ''">
                phone_no like concat(#{query} ,'%')
            </if>
        </where>
    </sql>

    <select id="selectCountByQuery" parameterType="com.zt.manage.domain.req.user.UserListQueryReq"
            resultType="java.lang.Integer">
        select count(id)
        <include refid="ListQuerySql"/>
    </select>

    <select id="selectListByQuery" parameterType="com.zt.manage.domain.req.user.UserListQueryReq"
            resultType="com.zt.manage.domain.resp.user.UserListResp">
        select user_id, user_name, phone_no, lock_status, create_time
        <include refid="ListQuerySql"/>
        order by create_time desc
        limit #{pageIndex}, #{pageSize}
    </select>
</mapper>